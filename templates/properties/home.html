{% extends 'base.html' %}
{% load static %}

{% block content %}
  {% if about %}
    {% if about.homepage_template == 'template1' %}
      {% include 'properties/homepage_templates/template1.html' %}
    {% elif about.homepage_template == 'template2' %}
      {% include 'properties/homepage_templates/template2.html' %}
    {% elif about.homepage_template == 'template3' %}
      {% include 'properties/homepage_templates/template3.html' %}
    {% elif about.homepage_template == 'template4' %}
      {% include 'properties/homepage_templates/template4.html' %}
    {% else %}
      {% include 'properties/homepage_templates/template1.html' %}
    {% endif %}
  {% else %}
    <!-- Default template if no settings configured -->
    {% include 'properties/homepage_templates/template1.html' %}
  {% endif %}

  <!-- Custom Sections -->
  {% for section in custom_sections %}
    {% if section.layout == 'text_only' %}
      {% include 'properties/custom_sections/text_only.html' %}
    {% elif section.layout == 'image_left' %}
      {% include 'properties/custom_sections/image_left.html' %}
    {% elif section.layout == 'image_right' %}
      {% include 'properties/custom_sections/image_right.html' %}
    {% elif section.layout == 'image_center' %}
      {% include 'properties/custom_sections/image_center.html' %}
    {% elif section.layout == 'cards' %}
      {% include 'properties/custom_sections/cards.html' %}
    {% elif section.layout == 'about_section' %}
      {% include 'properties/custom_sections/about_section.html' %}
    {% elif section.layout == 'services' %}
      {% include 'properties/custom_sections/services.html' %}
    {% endif %}
  {% endfor %}

  <!-- JSON-LD Structured Data for Home Page -->
  {% block structured_data %}
  {{ block.super }}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "RealEstate",
    "url": "{{ request.scheme }}://{{ request.get_host }}",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ request.scheme }}://{{ request.get_host }}{% url 'listings' %}?search={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  {% if about %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "RealEstate",
    "description": "{{ about.content|truncatewords:30 }}",
    "url": "{{ request.scheme }}://{{ request.get_host }}",
    {% if about.phone %}"telephone": "{{ about.phone }}",{% endif %}
    {% if about.email %}"email": "{{ about.email }}",{% endif %}
    {% if about.address %}"address": "{{ about.address }}",{% endif %}
    "sameAs": [
      {% if about.facebook_url %}"{{ about.facebook_url }}"{% endif %}
      {% if about.instagram_url %}{% if about.facebook_url %},{% endif %}"{{ about.instagram_url }}"{% endif %}
      {% if about.twitter_url %}{% if about.facebook_url or about.instagram_url %},{% endif %}"{{ about.twitter_url }}"{% endif %}
      {% if about.linkedin_url %}{% if about.facebook_url or about.instagram_url or about.twitter_url %},{% endif %}"{{ about.linkedin_url }}"{% endif %}
    ]
  }
  </script>
  {% endif %}
  {% endblock %}
{% endblock %}